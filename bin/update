#! /usr/bin/env sh
set -uf

pikaur -Syu --needed

(orphans="$(pikaur -Qtdq)" && update -Rns "$orphans")

# XXX: can be moved to update hooks
# keep three versions of installed packages
# and one version of uninstalled packages
paccache -vrk3
paccache -vruk1
paccache --cachedir ~/cache/pikaur/pkg -vrk3
paccache --cachedir ~/cache/pikaur/pkg -vruk1

if [ -d ~/pass/.git ]
then
    git -C ~/pass push
fi


if [ -x "$(command -v fwupdmgr)" ]
then
    fwupdmgr refresh && fwupdmgr get-updates
fi
